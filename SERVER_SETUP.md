# راهنمای نصب روی سرور

## مشکل متن‌های برعکس فارسی

اگر متن‌های فارسی روی سرور برعکس نمایش داده می‌شوند، این راهنما را دنبال کنید.

## 🎯 راه‌حل اصلی (تست شده)

**مشکل اصلی:** استفاده از کتابخانه `python-bidi` که روی برخی سرورها مشکل دارد.

**راه‌حل:** فقط از `arabic-reshaper` استفاده کنیم و `get_display()` را حذف کنیم.

### تغییرات اعمال شده:
1. ✅ حذف `python-bidi` از requirements
2. ✅ تابع پردازش متن ساده شد
3. ✅ فقط از `arabic_reshaper.reshape()` استفاده می‌شود
4. ✅ کنترل دستی برای انتخاب روش پردازش

## 🔧 راه‌حل‌ها

### 1. نصب کتابخانه ضروری

```bash
pip install arabic-reshaper
```

یا کل requirements:

```bash
pip install -r requirements.txt
```

### 2. بررسی نصب کتابخانه

```python
import arabic_reshaper

# تست
test_text = "سلام دنیا"
reshaped = arabic_reshaper.reshape(test_text)
print(f"اصلی: {test_text}")
print(f"پردازش شده: {reshaped}")
```

### 3. کنترل دستی در برنامه

برنامه حالا دارای **3 حالت** پردازش متن است:

1. **🤖 خودکار**: سیستم خودش تشخیص می‌دهد
2. **🔄 اجباری معکوس**: اگر متن برعکس است، این را انتخاب کنید  
3. **📝 بدون تغییر**: متن اصلی بدون هیچ پردازشی

**برای تغییر:** `تنظیمات` → `🔧 تشخیص مشکل متن فارسی` → انتخاب روش

### 4. برای سرورهای مختلف

#### Streamlit Cloud
1. فایل `requirements.txt` را به ریپو اضافه کنید
2. در deployment مجدداً deploy کنید

#### Heroku
```bash
heroku buildpacks:add heroku/python
```

#### DigitalOcean/VPS
```bash
sudo apt-get update
sudo apt-get install python3-pip
pip3 install -r requirements.txt
```

### 5. تنظیمات محیط

برای سرورهای Linux، ممکن است نیاز به تنظیم locale باشد:

```bash
export LC_ALL=C.UTF-8
export LANG=C.UTF-8
```

## 🐛 عیب‌یابی

### اگر همچنان مشکل دارید:

1. **بررسی نسخه Python**: حداقل 3.8+
2. **بررسی کتابخانه arabic-reshaper**: 
   ```bash
   pip list | grep arabic
   ```
3. **تست ساده**:
   ```python
   import arabic_reshaper
   text = "سلام"
   result = arabic_reshaper.reshape(text)
   print(f"نتیجه: {result}")
   ```

### در برنامه:

1. **برو به بخش تنظیمات**
2. **باز کن: "🔧 تشخیص مشکل متن فارسی"**  
3. **روش پردازش را تغییر بده:**
   - اگر متن برعکس است → "🔄 اجباری معکوس"
   - اگر هیچ کدام کار نکرد → "📝 بدون تغییر"

### وضعیت کتابخانه‌ها

برنامه خودش نشان می‌دهد:
- ✅ **سبز**: arabic-reshaper کار می‌کند
- ❌ **قرمز**: مشکل در نصب کتابخانه

## 📞 پشتیبانی

اگر مشکل برطرف نشد:

1. **اسکرین‌شات از صفحه debug** بگیرید
2. **خطای دقیق** را کپی کنید  
3. **نسخه Python** و **نوع سرور** را مشخص کنید
4. **نتیجه `pip list | grep arabic`** را بفرستید

## ⚡ راه‌حل فوری

**اگر عجله دارید:**

1. برو تنظیمات
2. باز کن "تشخیص مشکل متن فارسی"  
3. انتخاب کن "🔄 اجباری معکوس"
4. تست کن با متن "سلام دنیا"

✅ **باید درست کار کند!** 